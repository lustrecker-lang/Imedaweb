/**
 * @fileoverview Firestore Security Rules for the application.
 *
 * Core Philosophy:
 * This ruleset prioritizes authenticated access to all data.
 * It does not enforce strict schema validation during this prototyping phase.
 *
 * Data Structure:
 * - /pages/{pageId}: Stores content for specific pages. Accessible by authenticated users.
 * - /companyProfile/{profileId}: Stores company branding information. Accessible by authenticated users.
 *
 * Key Security Decisions:
 * - All read and write operations require authentication.
 * - No data is publicly accessible without authentication.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Controls access to page content.
     * @path /pages/{pageId}
     * @allow (get, list) if isSignedIn() - Allows any authenticated user to read the page content.
     * @allow (create, update, delete) if isSignedIn() - Allows any authenticated user to modify the page content.
     * @deny (create) if !isSignedIn() - Denies unauthenticated users from creating new pages.
     * @deny (update) if !isSignedIn() - Denies unauthenticated users from updating pages.
     * @deny (delete) if !isSignedIn() - Denies unauthenticated users from deleting pages.
     * @principle Requires authentication for all operations.
     */
    match /pages/{pageId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isSignedIn();
      allow delete: if isSignedIn();
    }

    /**
     * @description Controls access to company profile information.
     * @path /companyProfile/{profileId}
     * @allow (get, list) if isSignedIn() - Allows any authenticated user to read the company profile.
     * @allow (create, update, delete) if isSignedIn() - Allows any authenticated user to modify the company profile.
     * @deny (create) if !isSignedIn() - Denies unauthenticated users from creating new profiles.
     * @deny (update) if !isSignedIn() - Denies unauthenticated users from updating profiles.
     * @deny (delete) if !isSignedIn() - Denies unauthenticated users from deleting profiles.
     * @principle Requires authentication for all operations.
     */
    match /companyProfile/{profileId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isSignedIn();
      allow delete: if isSignedIn();
    }

    /**
     * @description Controls access to landing pages content.
     * @path /landing_pages/{pageId}
     * @allow (get, list) if isSignedIn() - Allows any authenticated user to read landing pages.
     * @allow (create, update, delete) if isSignedIn() - Allows any authenticated user to modify landing pages.
     * @principle Requires authentication for all operations.
     */
    match /landing_pages/{pageId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isSignedIn();
      allow delete: if isSignedIn();
    }

    function isSignedIn() {
      return request.auth != null;
    }
  }
}