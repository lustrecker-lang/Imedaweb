/**
 * @fileoverview Firestore Security Rules for Prototyping.
 *
 * Core Philosophy:
 * This ruleset prioritizes rapid prototyping by focusing on authorization and skipping data validation.
 * All authenticated users can read all data, but only authenticated users can create, update, and delete data.
 *
 * Data Structure:
 * - `/pages/{pageId}`: Stores page content.
 * - `/companyProfile/{profileId}`: Stores company branding information.
 *
 * Key Security Decisions:
 * - Read access is public for all authenticated users.
 * - Write access is restricted to authenticated users.
 * - No data validation is performed (e.g., field types, required fields).
 * - List operations are allowed for all authenticated users.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows authenticated users to read and write page content.
     * @path /pages/{pageId}
     * @allow (get, list) - Authenticated user reads page content.
     * @allow (create, update, delete) - Authenticated user creates, updates, or deletes page content.
     * @deny (create, update, delete) - Unauthenticated user attempts to write.
     * @principle Allows authenticated users to manage page content, with no data validation.
     */
    match /pages/{pageId} {
      allow get, list: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isSignedIn() && resource != null;
      allow delete: if isSignedIn() && resource != null;
    }

    /**
     * @description Allows authenticated users to read and write company profile information.
     * @path /companyProfile/{profileId}
     * @allow (get, list) - Authenticated user reads company profile.
     * @allow (create, update, delete) - Authenticated user creates, updates, or deletes company profile.
     * @deny (create, update, delete) - Unauthenticated user attempts to write.
     * @principle Allows authenticated users to manage company profile, with no data validation.
     */
    match /companyProfile/{profileId} {
      allow get, list: if isSignedIn();
      allow create: if isSignedIn();
      allow update: if isSignedIn() && resource != null;
      allow delete: if isSignedIn() && resource != null;
    }

    function isSignedIn() {
      return request.auth != null;
    }
  }
}